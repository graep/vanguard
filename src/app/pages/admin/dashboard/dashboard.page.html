<ion-content>
  <div class="content-container">
    
    <!-- Loading State -->
    <div class="loading-state" *ngIf="isLoading">
      <ion-spinner></ion-spinner>
      <p>Loading statistics...</p>
    </div>
    
    <!-- Statistics Content -->
    <div class="statistics-content" *ngIf="!isLoading">
      
      <!-- Page Header -->
      <div class="page-header">
        <div class="header-content">
          <div>
            <h1 class="page-title">Dashboard</h1>
            <p class="page-subtitle">Welcome, {{ userDisplayName }}!</p>
          </div>
          <div class="header-actions-container">
            <div class="header-actions">
              <ion-button fill="outline" size="small" (click)="toggleEditMode()" 
                          [class.edit-mode-active]="isEditMode" class="edit-mode-button">
                <ion-icon [name]="isEditMode ? 'lock-open-outline' : 'lock-closed-outline'" slot="start"></ion-icon>
                {{ isEditMode ? 'Exit Edit Mode' : 'Edit Layout' }}
              </ion-button>
              <ion-button fill="outline" size="small" (click)="resetLayout()" class="reset-button" [disabled]="!isEditMode">
                <ion-icon name="refresh-outline" slot="start"></ion-icon>
                Reset Layout
              </ion-button>
              <ion-button fill="outline" size="small" (click)="resetAllTileColors()" class="reset-colors-button" [disabled]="!isEditMode">
                <ion-icon name="color-palette-outline" slot="start"></ion-icon>
                Reset Colors
              </ion-button>
            </div>
          </div>
        </div>
        <div class="edit-mode-indicator" *ngIf="isEditMode">
          <ion-icon name="create-outline"></ion-icon>
          <span>Edit Mode Active - Drag tiles to rearrange</span>
        </div>
      </div>
      
      <!-- Unified Statistics Grid -->
      <app-statistics-grid
        [cards]="allCards"
        [isEditMode]="isEditMode"
        [vanStats]="vanStats"
        [inspectionStats]="inspectionStats"
        [driverStats]="driverStats"
        [operationalHealth]="operationalHealth"
        (cardMoved)="moveCard($event)"
        (cardColorChanged)="onCardColorChanged($event)">
      </app-statistics-grid>
      
    </div>
  </div>
</ion-content>
